---
interface Props {
  currentPath?: string;
}

const { currentPath = '/' } = Astro.props;

const services = [
  { href: '/services/wordpress-maintenance', label: 'WordPress Maintenance', description: 'Updates, backups, security & support' },
  { href: '/services/wordpress-security', label: 'WordPress Security', description: 'Protection from threats & malware' },
  { href: '/services/speed-optimisation', label: 'Speed Optimisation', description: 'Faster loading, better Core Web Vitals' },
  { href: '/services/wordpress-backup', label: 'WordPress Backup', description: 'Daily backups & disaster recovery' },
  { href: '/services/wordpress-migration', label: 'WordPress Migration', description: 'Free site transfer to SparkHost' },
  { href: '/services/woocommerce-hosting', label: 'WooCommerce Hosting', description: 'E-commerce optimised hosting' },
  { href: '/services/wordpress-support', label: 'WordPress Support', description: 'Expert help via WhatsApp & email' },
  { href: '/services/gdpr-compliance', label: 'GDPR Compliance', description: 'EU data storage & privacy setup' },
];

const navLinks = [
  { href: '/pricing', label: 'Pricing' },
  { href: '/about', label: 'About' },
  { href: '/blog', label: 'Blog' },
  { href: '/faq', label: 'FAQ' },
  { href: '/contact', label: 'Contact' },
];
---

<header class="fixed top-0 left-0 right-0 z-50">
  <!-- Gradient blur backdrop -->
  <div class="absolute inset-0 bg-gradient-to-b from-[var(--color-deep-navy)] via-[var(--color-deep-navy)]/95 to-transparent backdrop-blur-xl"></div>

  <nav class="relative max-w-7xl mx-auto px-6 py-4">
    <div class="flex items-center justify-between">
      <!-- Logo -->
      <a href="/" class="relative group">
        <img
          src="/sparkhost-light.svg"
          alt="SparkHost"
          class="h-10 w-auto transition-transform duration-300 group-hover:scale-105"
        />
        <!-- Glow effect on hover -->
        <div class="absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300 blur-xl bg-gradient-to-r from-[var(--color-spark-red)]/20 to-[var(--color-spark-orange)]/20 -z-10"></div>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden lg:flex items-center gap-1">
        <!-- Services Dropdown -->
        <div class="relative group">
          <a
            href="/services"
            class:list={[
              "relative px-4 py-2 font-medium text-sm transition-all duration-300 flex items-center gap-1",
              currentPath.startsWith('/services')
                ? "text-white"
                : "text-white/60 hover:text-white"
            ]}
          >
            Services
            <svg class="w-4 h-4 transition-transform duration-200 group-hover:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
            {currentPath.startsWith('/services') && (
              <span class="absolute bottom-0 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full bg-[var(--color-spark-red)] shadow-[0_0_8px_var(--color-spark-red)]"></span>
            )}
            <span class="absolute inset-0 rounded-lg bg-white/0 hover:bg-white/5 transition-colors duration-300"></span>
          </a>

          <!-- Dropdown Menu -->
          <div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
            <div class="bg-[var(--color-deep-navy)]/95 backdrop-blur-xl border border-white/10 rounded-xl p-2 min-w-[280px] shadow-2xl shadow-black/30">
              {services.map((service) => (
                <a
                  href={service.href}
                  class:list={[
                    "flex flex-col gap-0.5 px-4 py-3 rounded-lg transition-all duration-200",
                    currentPath === service.href
                      ? "bg-white/10 text-white"
                      : "hover:bg-white/5 text-white/80 hover:text-white"
                  ]}
                >
                  <span class="font-medium text-sm">{service.label}</span>
                  <span class="text-xs text-white/50">{service.description}</span>
                </a>
              ))}
              <div class="border-t border-white/10 mt-2 pt-2">
                <a
                  href="/services"
                  class="flex items-center gap-2 px-4 py-2 rounded-lg text-sm text-[var(--color-spark-orange)] hover:bg-white/5 transition-colors"
                >
                  View All Services
                  <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                  </svg>
                </a>
              </div>
            </div>
          </div>
        </div>

        {navLinks.map((link) => (
          <a
            href={link.href}
            class:list={[
              "relative px-4 py-2 font-medium text-sm transition-all duration-300",
              currentPath === link.href
                ? "text-white"
                : "text-white/60 hover:text-white"
            ]}
          >
            {link.label}
            {currentPath === link.href && (
              <span class="absolute bottom-0 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full bg-[var(--color-spark-red)] shadow-[0_0_8px_var(--color-spark-red)]"></span>
            )}
            <span class="absolute inset-0 rounded-lg bg-white/0 hover:bg-white/5 transition-colors duration-300"></span>
          </a>
        ))}
      </div>

      <!-- CTA Button -->
      <div class="hidden lg:flex items-center gap-4">
        <a href="/get-started" class="btn-spark text-sm py-2.5 px-5" title="Start your managed WordPress hosting">
          <span>Get Started</span>
          <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
          </svg>
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <button
        id="mobile-menu-btn"
        class="lg:hidden relative p-2 rounded-lg bg-white/5 border border-white/10 hover:bg-white/10 transition-colors"
        aria-label="Toggle menu"
      >
        <div class="w-5 h-4 flex flex-col justify-between" id="hamburger">
          <span class="block h-0.5 w-full bg-white rounded-full transition-transform origin-center"></span>
          <span class="block h-0.5 w-full bg-white rounded-full transition-opacity"></span>
          <span class="block h-0.5 w-full bg-white rounded-full transition-transform origin-center"></span>
        </div>
      </button>
    </div>
  </nav>

  <!-- Mobile Menu -->
  <div
    id="mobile-menu"
    class="lg:hidden fixed inset-x-0 top-[72px] bottom-0 bg-[var(--color-deep-navy)]/98 backdrop-blur-2xl translate-x-full transition-transform duration-500 ease-out overflow-y-auto"
  >
    <div class="flex flex-col p-6 gap-2">
      <!-- Services Section -->
      <div class="border-b border-white/5 pb-2 mb-2">
        <a
          href="/services"
          class="group relative py-3 px-4 text-lg font-semibold text-white/90 hover:text-white transition-all duration-300 flex items-center justify-between"
        >
          <span>Services</span>
          <svg class="w-5 h-5 text-white/40" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
        </a>
        <div class="pl-4 space-y-1">
          {services.map((service, i) => (
            <a
              href={service.href}
              class="group relative py-2.5 px-4 text-base text-white/60 hover:text-white transition-all duration-300 flex flex-col"
              style={`transition-delay: ${i * 30}ms`}
            >
              <span class="relative z-10">{service.label}</span>
              <span class="text-xs text-white/40">{service.description}</span>
              <div class="absolute inset-0 bg-gradient-to-r from-[var(--color-spark-red)]/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-lg"></div>
            </a>
          ))}
        </div>
      </div>

      {navLinks.map((link, i) => (
        <a
          href={link.href}
          class="group relative py-4 px-4 text-xl font-medium text-white/70 hover:text-white transition-all duration-300 border-b border-white/5"
          style={`transition-delay: ${(i + services.length) * 50}ms`}
        >
          <span class="relative z-10">{link.label}</span>
          <div class="absolute inset-0 bg-gradient-to-r from-[var(--color-spark-red)]/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-lg"></div>
        </a>
      ))}

      <a href="/get-started" class="btn-spark mt-6 justify-center text-lg py-4" title="Start your managed WordPress hosting">
        <span>Get Started</span>
        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
        </svg>
      </a>
    </div>
  </div>
</header>

<script>
  const menuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');
  const hamburger = document.getElementById('hamburger');
  let isOpen = false;

  menuBtn?.addEventListener('click', () => {
    isOpen = !isOpen;

    if (isOpen) {
      mobileMenu?.classList.remove('translate-x-full');
      mobileMenu?.classList.add('translate-x-0');
      // Animate hamburger to X
      const spans = hamburger?.querySelectorAll('span');
      if (spans) {
        spans[0].style.transform = 'translateY(7px) rotate(45deg)';
        spans[1].style.opacity = '0';
        spans[2].style.transform = 'translateY(-7px) rotate(-45deg)';
      }
    } else {
      mobileMenu?.classList.remove('translate-x-0');
      mobileMenu?.classList.add('translate-x-full');
      // Reset hamburger
      const spans = hamburger?.querySelectorAll('span');
      if (spans) {
        spans[0].style.transform = '';
        spans[1].style.opacity = '1';
        spans[2].style.transform = '';
      }
    }
  });
</script>
